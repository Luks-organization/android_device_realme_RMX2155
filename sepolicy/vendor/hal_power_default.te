typeattribute hal_power_default mlstrustedsubject;

# Set scheduling info for apps (for adpf)
allow hal_power_default appdomain:process { getsched setsched };
allow hal_power_default self:capability sys_nice;

# Set scheduling info for HWC (for adpf)
allow hal_power_default hal_graphics_composer_default:process setsched;

# Set scheduling info for system_server (for adpf)
allow hal_power_default system_server:process setsched;

# Set CPU frequency
allow hal_power_default sysfs_mtk_cpufreq:file rw_file_perms;

# Set GPU frequency
allow hal_power_default vendor_sysfs_gpu:dir r_dir_perms;
allow hal_power_default vendor_sysfs_gpu:file rw_file_perms;
allow hal_power_default sysfs_mtk_gpufreq:file rw_file_perms;
allow hal_power_default sysfs_gpu:dir r_dir_perms;
allow hal_power_default sysfs_gpu:file rw_file_perms;

# Set perfmgr nodes
allow hal_power_default cpu_dma_latency_device:chr_file rw_file_perms;
allow hal_power_default proc:file { open write };
allow hal_power_default proc_perfmgr:dir r_dir_perms;
allow hal_power_default proc_ppm:dir r_dir_perms;
allow hal_power_default proc_ppm:file rw_file_perms;
allow hal_power_default proc_cpufreq:dir r_dir_perms;
allow hal_power_default proc_cpufreq:file rw_file_perms;
allow hal_power_default proc_gpufreq:dir r_dir_perms;
allow hal_power_default proc_gpufreq:file rw_file_perms;
allow hal_power_default proc_hps:dir r_dir_perms;
allow hal_power_default proc_hps:file rw_file_perms;
allow hal_power_default proc_cm_mgr:dir r_dir_perms;
allow hal_power_default proc_cm_mgr:file rw_file_perms;
allow hal_power_default proc_fliperfs:dir r_dir_perms;
allow hal_power_default proc_fliperfs:file rw_file_perms;
allow hal_power_default sysfs_fbt_cpu:dir r_dir_perms;
allow hal_power_default sysfs_fbt_cpu:file rw_file_perms;
allow hal_power_default sysfs_fbt_fteh:dir r_dir_perms;
allow hal_power_default sysfs_fbt_fteh:file rw_file_perms;
allow hal_power_default sysfs_xgf:dir r_dir_perms;
allow hal_power_default sysfs_xgf:file rw_file_perms;
allow hal_power_default sysfs_gbe:dir r_dir_perms;
allow hal_power_default sysfs_gbe:file rw_file_perms;
allow hal_power_default shell:fifo_file write;
allow hal_power_default fwk_stats_service:service_manager find;
allow hal_power_default gbe_native:dir r_dir_perms;
allow hal_power_default gbe_native:file r_file_perms;
allow hal_power_default fpsgo_native:dir r_dir_perms;
allow hal_power_default fpsgo_native:file r_file_perms;
allow hal_power_default hal_thermal_service:service_manager find;

# Set scheduling info for surfaceflinger (for adpf)
allow hal_power_default surfaceflinger:process setsched;

# Allow reading proc files for CPU statistics.
allow hal_power_default proc_stat:file r_file_perms;
allow hal_power_default proc_vendor_sched:dir r_dir_perms;
allow hal_power_default proc_vendor_sched:file r_file_perms;

# Allow read/write thermal sysfs and property
allow hal_power_default thermal_link_device:dir r_dir_perms;
allow hal_power_default sysfs_thermal:dir r_dir_perms;
allow hal_power_default sysfs_thermal:file rw_file_perms;
allow hal_power_default sysfs_thermal:lnk_file r_file_perms;
get_prop(hal_power_default, vendor_thermal_prop)

# Display
allow hal_power_default vendor_proc_display:dir search;
allow hal_power_default vendor_proc_display:file rw_file_perms;

# Allow libperfmgr to control GPU boost
r_dir_file(hal_power_default, sysfs_fpsgo)
r_dir_file(hal_power_default, sysfs_ged)
allow hal_power_default sysfs_fpsgo:file w_file_perms;
allow hal_power_default sysfs_ged:file w_file_perms;

# Call
binder_call(hal_power_default, stats_service_server);
binder_call(hal_power_default, hal_graphics_composer_default);
