typeattribute hal_sensors_default socket_between_core_and_vendor_violators;
hal_client_domain(hal_sensors_default, hal_lineage_oplus_als)

r_dir_file(hal_sensors_default, vendor_proc_oplus_sensor_feature)
r_dir_file(hal_sensors_default, vendor_sysfs_oplus_virtual_sensor)
r_dir_file(hal_sensors_default, vendor_proc_oplus_sensor_als)
r_dir_file(hal_sensors_default, vendor_sysfs_graphics)
r_dir_file(hal_sensors_default, persist_engineer_file)
r_dir_file(hal_sensors_default, sysfs_leds)

allow hal_sensors_default vendor_proc_oplus_sensor_feature:dir { search };
allow hal_sensors_default mnt_vendor_file:dir r_dir_perms;
allow hal_sensors_default mnt_vendor_file:file rw_file_perms;
allow hal_sensors_default persist_data_file:dir { getattr search };

allow hal_sensors_default vendor_sysfs_oplus_virtual_sensor:file w_file_perms;
allow hal_sensors_default vendor_proc_oplus_sensor_param:file r_file_perms;
allow hal_sensors_default virtual_sensor_device:chr_file r_file_perms;

allow hal_sensors_default als_ps_device:chr_file r_file_perms;
allow hal_sensors_default vendor_proc_oplus_sensor_cali:dir { search };
allow hal_sensors_default vendor_proc_oplus_sensor_cali:file rw_file_perms;
allow hal_sensors_default hal_system_suspend_service:service_manager find;

allow hal_sensors_default oplus_block_device:blk_file r_file_perms;
allow hal_sensors_default block_device:dir { search };
allow hal_sensors_default unlabeled:dir { search };

allow hal_sensors_default oplus_sensor_file:dir r_dir_perms;
allow hal_sensors_default oplus_sensor_file:file r_file_perms;
allow hal_sensors_default device:dir r_dir_perms;
allow hal_sensors_default hidraw_device:chr_file rw_file_perms;
allow hal_sensors_default vendor_proc_oplus_sensor_als:file w_file_perms;

get_prop(hal_sensors_default, system_sensors_als_prop)
get_prop(hal_sensors_default, vendor_default_prop)
